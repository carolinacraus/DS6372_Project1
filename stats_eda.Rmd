---
title: "Applied Stat Project 1"
author: "Joey Hernandez"
date: "2023-01-22"
output: html_document
---


```{r}
library(tidyverse)
library(naniar)
dataset <- read.csv("C:/Users/Joey/Desktop/applied-stats/datasets/data1.csv")
#glimpse(dataset) # looking at the var types of each
summary(dataset) # visually looking at dataset
vis_miss(dataset) # viz looking @ missing values

```
Var. that contain NA:

Engine.HP = 69

Engine.Cylinders = 30

Number.of.Doors = 6 

Since many of the missing values seem to be found we will input them into the dataset below instead of removing those observations.

Number of Doors: All NA values here were found and input into the dataset.
```{r}
#updating NA for Doors
dataset[6931:6935,9] <- 4 # Tesla model S
dataset[4667,9] <- 2 # Ferrari FF 

```


Engine Cylinders

The Mazda RX-7, and RX-8 use a unique rotary Engine and thus technically have no cylinders. This will remain NA for now. 

The remaining NA values come from electric vehicles and have been updated to 0 to match the other electric vehicles.
```{r}
dataset[1984:1985, 6] <- 0 # chevy bolt EV
dataset[3717:3720, 6] <- 0 # volkswagen e-golf
dataset[5779:5781,6] <- 0 # mitsubishi i-miev
dataset[8374,6] <- 0 # toyota rav4-ev
dataset[c(5826,5831,5832,5834,5840,5841),6]<- 305 # chevy impala flex-fuel
dataset[c(6909,6911,6917,6919),6]<-240 # lincoln mkz

```

Engine HP

Certain cars specifically electric vehicles do not report "horsepower" but instead will report Kilowatts (KW)
so we expect to see many Missing values when dealing with Electric vehicles. 

Exceptions to this:
Chevy Spark - GM reports 140 HP
i3 - BMW reports 170-181 HP
i-MiEV - Mitsubishi reports 66 HP
e-golf - Volkswagen reports 115 HP


```{r}
dataset[8374,5] <- 'NA' # toyota RAV4-EV
dataset[2906:2909,5] <- 305 # lincoln Continental
dataset[4204:4207,5]<- 168 # ford escape
dataset[4915:4920,5]<- 193 # ford freestar


car_data <- dataset

```


"Unknown" Data values in the Transmission.Type category
Dodge Ram 150 could be a duplicate? 

```{r}
car_data[1290:1291, 7] <- "AUTOMATIC" # oldsmobile achieva
car_data[4692,7]<- "MANUAL" # cheaper firebird
car_data[4693:4694,7]<- "AUTOMATIC" #more expensive firebird
car_data[6159,7] <- "MANUAL" # GMC Jimmy cheaper 99
car_data[6161,7] <- "AUTOMATIC" # GMC jimmy 99
car_data[6166,7] <- "MANUAL" #gmc jimmy 00
car_data[6175,7]<- "AUTOMATIC" # gmc jimmy 00
car_data[6367,7] <- "MANUAL" # chrysler le baron 
car_data[6369,7] <- "AUTOMATIC"# chrysler le baron 
car_data[c(8043,8044,8047,8048,8049,8050,8052,8054),7] <- "AUTOMATIC" # dodge ram 150

#view(car_data)

```

upon further investigation we find that there are many "N/A" values within the 
Market.Category column (3742) which could infact mean there is no applicable group that it fits into. we will change this N/A to No Category
```{r}

sum(car_data$Market.Category == "N/A")

```


There are many chr and int types so we will change them into a factor where needed so that we can adequately plot the data.
```{r}
car_data$Make <- as.factor(car_data$Make)
car_data$Model<-as.factor(car_data$Model)
#car_data$Year<-as.factor(car_data$Year)
car_data$Engine.Fuel.Type<- as.factor(car_data$Engine.Fuel.Type)
car_data$Engine.HP<- as.numeric(car_data$Engine.HP) # na values from elec. vehic. 
car_data$Engine.Cylinders<-as.factor(car_data$Engine.Cylinders)
car_data$Transmission.Type<-as.factor(car_data$Transmission.Type)
car_data$Driven_Wheels<- as.factor(car_data$Driven_Wheels)
car_data$Number.of.Doors<- as.factor(car_data$Number.of.Doors)
car_data$Market.Category<-as.factor(car_data$Market.Category)
car_data$Vehicle.Size<-as.factor(car_data$Vehicle.Size)
car_data$Vehicle.Style<-as.factor(car_data$Vehicle.Style)
```
viz: variables in dataset
```{r}
glimpse(car_data)

# which make of car has the highest count? 
car_data %>% ggplot(aes(Make)) + 
  geom_bar(stat = 'count') + coord_flip()

# mpg distribution between cars
car_data %>% ggplot(aes(city.mpg))+
  geom_histogram()
#mean(car_data$city.mpg)
#
# hwy dist. between cars
car_data %>% ggplot(aes(highway.MPG))+
  geom_histogram() # is there a report for EV? 

# number of doors bar plot
car_data %>% ggplot(aes(Number.of.Doors))+
  geom_bar() # most cars have 4 doors (sedans)

car_data %>% ggplot(aes(Vehicle.Style))+
  geom_bar() + coord_flip() # this sedan and 4dr suv matches what we saw earlier. 

car_data %>% ggplot(aes(Transmission.Type))+
  geom_bar()  # are there any electric cars listed as something other than direct_drive? 

# Engine HP dist. 
car_data %>% ggplot(aes(Engine.HP)) +
  geom_histogram() # EV typically do no report this. that should prob be considered if we are 
# using this to predict prices of EV..

car_data %>% ggplot(aes(Popularity))+
  geom_histogram() # not sure how this is rated.. but theres a huge part missing 
 # most tend to be found in 0 - just above 2000

glimpse(car_data)

# representation of drive type (AWD,FWD, 4WD etc)
car_data %>% ggplot(aes(Driven_Wheels))+
  geom_bar()

# right skewed data for Year (which makes sense since we expect to be selling "newer" vehicles)
car_data %>% ggplot(aes(Year)) +
  geom_bar()

car_data %>% ggplot(aes(Engine.Fuel.Type))+
  geom_bar() + coord_flip()

```

this chunk is to look at MSRP broken into different ranges and finally logged
```{r}
car_data %>% ggplot(aes(MSRP))+
  geom_histogram()

car_data %>% filter(MSRP <=20000) %>% ggplot(aes(MSRP)) +
  geom_histogram()

car_data %>% filter(MSRP <=40000) %>% ggplot(aes(MSRP)) +
  geom_histogram()

car_data %>% filter(MSRP <=60000) %>% ggplot(aes(MSRP)) +
  geom_histogram()

car_data %>% filter(MSRP <=80000) %>% ggplot(aes(MSRP)) +
  geom_histogram()

car_data %>% filter(MSRP <=100000) %>% ggplot(aes(MSRP)) +
  geom_histogram()

car_data %>% ggplot(aes(log(MSRP)))+
  geom_histogram()

max(car_data$MSRP)
```


viz - of some intuitive relationships
should be noted that since we are dealing with MSRP we may need to scale the data so that it can be visualized properly.
Numerical data
```{r}
glimpse(car_data)
# numerical 
par(mfrow = c(2,2))
# city mpg
plot(log(car_data$city.mpg),log(car_data$MSRP), main = "city mpg")
#hwy mpg
plot(log(car_data$highway.MPG), log(car_data$MSRP), main = "hwy mpg")
# popularity
plot(log(car_data$Popularity), log(car_data$MSRP), main = "popular") # this looks irrelevant ?

```

categorical data -1 
```{r}
library(ggplot2)

# categorical 
par(mfrow = c(2,3))
# Veh. Style
plot(car_data$Vehicle.Style, log(car_data$MSRP), main = "vehicle style")
# make
plot(car_data$Make,log(car_data$MSRP), main = "make")
# year 
plot(car_data$Year, log(car_data$MSRP), main = "year")

car_data %>% filter(Year <= "2000") %>% ggplot(aes(Year, MSRP)) +
  geom_point()

car_data %>% filter(Year >= "2000" ) %>% ggplot(aes(Year, MSRP))+
  geom_point()

# fuel type
plot(car_data$Engine.Fuel.Type, log(car_data$MSRP), main = "fuel type")
# HP 
plot(car_data$Engine.HP, log(car_data$MSRP), main = "horse power")
# cylinders
plot(car_data$Engine.Cylinders, log(car_data$MSRP), main = "cylinders")
```

categorical data -2
```{r}
par(mfrow = c(2,3))
# transmission type
plot(car_data$Transmission.Type, log(car_data$MSRP), main = "trans. type")
# wheel drive
plot(car_data$Driven_Wheels, log(car_data$MSRP), main = "wheel drive")
# number of doors
plot(car_data$Number.of.Doors, log(car_data$MSRP), main = "num of doors")
# market category
plot(car_data$Market.Category, log(car_data$MSRP), main = "market category")  #there is big chunk of missing values this may be unreliable
# size
plot(car_data$Vehicle.Size, log(car_data$MSRP), main = "vehicle size")
# style
plot(car_data$Vehicle.Style, log(car_data$MSRP), main = "vehicle style")

```


